# 지하철 노선도 미션
스프링 과정 실습을 위한 지하철 노선도 애플리케이션

---

## 기능 요구사항 목록

### 지하철 역 관리

- 지하철역 등록
  - [x] 지하철역 생성 시 이미 등록된 이름으로 요창한다면 에러를 응답
- 지하철역 목록
  - [x] 저장된 전체 지하철역 목록을 조회할 수 있다.
- 지하철역 삭제
  - [x] HTTP request로 넘겨져온 id 값을 통해서 지하철역을 삭제할 수 있다.

### 노선 관리

- 노선 등록
  - [x] 노선 생성 시 이미 등록된 이름으로 요청한다면 에러를 응답
- 노선 조회
  - [x] HTTP request로 넘겨져 온 id값을 통해서 지하철 노선을 조회할 수 있다.
  - 저장된 전체 지하철 노선 목록을 조회할 수 있다.
- 노선 수정
  - [x] HTTP request로 넘겨져 온 id 값을 통해서 지하철 노선 정보(이름과 색상)를 변경할 수 있다.
- 노선 삭제
  - [x] HTTP request로 넘겨져 온 id값을 통해서 지하철 노선을 삭제할 수 있다.

### 구간 관리

- 지하철 노선 추가 API 수정
  - [x] 노선 추가시 3가지 정보를 추가로 입력 받는다.
    - upStationId : 상행 종점
    - downStationId : 하행 종점
    - distance : 두 종점간의 거리
  - [x] 두 종점간의 연겨 정보를 이용하여 노선 추가 시 구간(Section) 정보도 함께 등록한다.

- 구간 관리 API 구현
  - [x] 노선에 구간을 추가한다.
  - [x] 노선에 포함된 구간 정보를 통해 상행 종점부터 하행 종점까지의 역 목록을 응답한다.
  - [x] 구간을 제거할 수 있다.

- 구간 등록 
  - [x] 새로 등록할 구간의 상행역과 하행역 중 노선에 이미 등록되어 있는 역을 기준으로 새로운 구간을 추가한다.
  - [x] 하나의 노선에는 갈래길이 허용되지 않기 때문에 새로운 구간이 추가되기 전에 갈래길이 생기지 않도록 기존 구간을 변경한다.

- 예외
  - [x] 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없다.
  - [x] 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가할 수 없다.
  - [x] 상행역과 하행역 둘 중 하나도 포함되어 있지 않으면 추가할 수 없다.

- 구간 제거
  - [x] 종점이 제거될 경우 다음으로 오던 역이 종점이 된다.
  - [x] 중간역이 제거될 경우 재배치를 한다.
    - 노선에 `A - B - C` 역이 연결되어 있을 때 B역을 제거할 경우 `A - C` 로 재배치된다.
    - 거리는 두 구간의 거리의 합으로 정해진다.

- 예외
  - [x] 구간이 하나인 노선에서 마지막 구간을 제거할 수 없다.

---

## 프로그래밍 요구 사항

- End To End 테스트를 작성한다.
- Spring JDBC를 활용하여 DB에서 관리
- 스프링 빈 활용하기

---

# 지하철 경로 조회 미션

- [x] 출발역과 도착역 사이의 최단 거리 경로를 구하는 API를 구현하기
- [x] 검색 시 경로와 함께 총 거리와 요금을 출력하기
- [x] 한 노선에서 경로 찾기 뿐만 아니라 여러 노선의 환승도 고려하기

- [x] 경로 조회 API 구현하기
- [x] 요금 계산 구현하기
  - 기본운임(10㎞ 이내): 기본운임 1,250원
  - 이용 거리 초과 시 추가운임 부과
  - 10km~50km: 5km 까지 마다 100원 추가
  - 50km 초과: 8km 까지 마다 100원 추가

- [ ] 노선별 추가 요금
  - [ ] 추가 요금이 있는 노선을 이용 할 경우 측정된 요금에 추가한다.
    - ex) 900원 추가 요금이 있는 노선 8km 이용 시 1,250원 -> 2,150원
    - ex) 900원 추가 요금이 있는 노선 12km 이용 시 1,350원 -> 2,250원
  - [ ] 경로 중 추가요금이 있는 노선을 환승 하여 이용 할 경우 가장 높은 금액의 추가 요금만 적용
    - ex) 0원, 500원, 900원의 추가 요금이 있는 노선들을 경유하여 8km 이용 시 1,250원 -> 2,150원

- [ ] 연령별 요금 할인
  - [ ] 청소년: 운임에서 350원을 공제한 금액의 20% 할인
  - [ ] 어린이: 운임에서 350원을 공제한 금액의 50% 할인
